<div class="problem-analysis"><div class="problem-analysis-header"><h4 class="header-4">Analysis</h4></div> <div class="problem-description"><p><h3>Test set 1</h3>

<p>
  In order to verify that a segment is good, we need to check whether all the cells in that segment
  contain <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-382-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3637" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1000.46em, 2.389em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3638"><span class="mn" id="MathJax-Span-3639" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-382">1</script> or not.

To check whether all the cells in a segment contain <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-383-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3640" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1000.46em, 2.389em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3641"><span class="mn" id="MathJax-Span-3642" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-383">1</script> or not, we can calculate prefix sum of
the matrix and then check whether sum of cells on this segment is equal to the length of the
segment or not. Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-384-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3643" style="width: 7.162em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.48em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1006.37em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3644"><span class="mi" id="MathJax-Span-3645" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3646" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-3647" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3648" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-3649" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3650" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3651" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3652" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3653" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">b</span><span class="mo" id="MathJax-Span-3654" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3655" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">c</span><span class="mo" id="MathJax-Span-3656" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3657" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3658" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-384">query(a,b,c,d)</script> denote the sum of cells in submatrix with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-385-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3659" style="width: 2.446em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.219em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1002.11em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3660"><span class="mo" id="MathJax-Span-3661" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3662" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3663" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3664" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">b</span><span class="mo" id="MathJax-Span-3665" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-385">(a,b)</script> as top left corner
and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-386-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>c</mi><mo>,</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3666" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.162em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1002.05em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3667"><span class="mo" id="MathJax-Span-3668" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3669" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-3670" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3671" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3672" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>c</mi><mo>,</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-386">(c,d)</script> as bottom right corner. We can calculate
this sum in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-387-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3673" style="width: 2.276em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.048em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.93em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3674"><span class="mi" id="MathJax-Span-3675" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-3676" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-3677" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3678" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-387">O(1)</script> using the prefix sum matrix. For more details on using prefix sum to calculate sum
of cells on a submatrix, please refer
<a href="https://www.geeksforgeeks.org/submatrix-sum-queries/">this</a>.
In order to get the sum of cells on segment from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-388-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3679" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3680"><span class="mo" id="MathJax-Span-3681" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3682" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3683" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3684" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-3685" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-388">(i,j)</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-389-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3686" style="width: 2.105em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.878em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.76em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3687"><span class="mo" id="MathJax-Span-3688" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3689" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3690" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3691" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mo" id="MathJax-Span-3692" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-389">(i,l)</script>, we can simply check if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-390-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>j</mi><mo>&amp;#x2212;</mo><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3693" style="width: 12.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.594em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1011.54em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3694"><span class="mi" id="MathJax-Span-3695" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3696" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-3697" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3698" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-3699" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3700" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3701" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3702" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3703" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-3704" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3705" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">i</span><span class="mo" id="MathJax-Span-3706" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3707" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mo" id="MathJax-Span-3708" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3709" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="texatom" id="MathJax-Span-3710" style="padding-left: 0.287em;"><span class="mrow" id="MathJax-Span-3711"><span class="mo" id="MathJax-Span-3712" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3713" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3714" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3715" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">l</span><span class="texatom" id="MathJax-Span-3716"><span class="mrow" id="MathJax-Span-3717"><span class="mo" id="MathJax-Span-3718" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3719" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3720" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>j</mi><mo>−</mo><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-390">query(i,j,i,l) = |j-l|+1</script>.

</p>

<p>
  L-shape comprises of two segments which meet at a common point.
  Except the common point, consider the other end point of one segment as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-391-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3721" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3722"><span class="mo" id="MathJax-Span-3723" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3724" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3725" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3726" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-3727" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-391">(i,j)</script> and the end point of the other segment as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-392-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3728" style="width: 2.276em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.048em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.93em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3729"><span class="mo" id="MathJax-Span-3730" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3731" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3732" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3733" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mo" id="MathJax-Span-3734" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-392">(k,l)</script>. Now
  these end points could meet at either <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-393-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3735" style="width: 2.105em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.878em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.76em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3736"><span class="mo" id="MathJax-Span-3737" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3738" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3739" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3740" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mo" id="MathJax-Span-3741" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-393">(i,l)</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-394-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3742" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.162em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1002.05em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3743"><span class="mo" id="MathJax-Span-3744" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3745" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3746" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3747" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-3748" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-394">(k,j)</script> to
  form an L-shape. So, if we know the end points of each segment, we can figure out the common point
  where segments would meet.
</p>

<p>
   For each pair of end points <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-395-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3749" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3750"><span class="mo" id="MathJax-Span-3751" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3752" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3753" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3754" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-3755" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-395">(i,j)</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-396-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3756" style="width: 2.276em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.048em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.93em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3757"><span class="mo" id="MathJax-Span-3758" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3759" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3760" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3761" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mo" id="MathJax-Span-3762" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-396">(k,l)</script> of segments of L-shape, we already saw that there could be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-397-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3763" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1000.46em, 2.389em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3764"><span class="mn" id="MathJax-Span-3765" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-397">2</script> possible meeting points.
  </p><ul>
    <li>
      For segments meeting at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-398-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3766" style="width: 2.105em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.878em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.76em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3767"><span class="mo" id="MathJax-Span-3768" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3769" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3770" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3771" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mo" id="MathJax-Span-3772" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-398">(i,l)</script>, check that
      <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-399-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>j</mi><mo>&amp;#x2212;</mo><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3773" style="width: 12.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.594em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1011.54em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3774"><span class="mi" id="MathJax-Span-3775" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3776" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-3777" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3778" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-3779" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3780" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3781" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3782" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3783" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-3784" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3785" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">i</span><span class="mo" id="MathJax-Span-3786" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3787" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mo" id="MathJax-Span-3788" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3789" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="texatom" id="MathJax-Span-3790" style="padding-left: 0.287em;"><span class="mrow" id="MathJax-Span-3791"><span class="mo" id="MathJax-Span-3792" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3793" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3794" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3795" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">l</span><span class="texatom" id="MathJax-Span-3796"><span class="mrow" id="MathJax-Span-3797"><span class="mo" id="MathJax-Span-3798" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3799" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3800" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>j</mi><mo>−</mo><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-399">query(i,j,i,l) = |j-l|+1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-400-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>i</mi><mo>&amp;#x2212;</mo><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3801" style="width: 12.957em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.764em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1011.71em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3802"><span class="mi" id="MathJax-Span-3803" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3804" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-3805" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3806" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-3807" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3808" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3809" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3810" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3811" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mo" id="MathJax-Span-3812" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3813" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">i</span><span class="mo" id="MathJax-Span-3814" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3815" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mo" id="MathJax-Span-3816" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3817" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="texatom" id="MathJax-Span-3818" style="padding-left: 0.287em;"><span class="mrow" id="MathJax-Span-3819"><span class="mo" id="MathJax-Span-3820" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3821" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3822" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3823" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">k</span><span class="texatom" id="MathJax-Span-3824"><span class="mrow" id="MathJax-Span-3825"><span class="mo" id="MathJax-Span-3826" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3827" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3828" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy="false">(</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo>,</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>i</mi><mo>−</mo><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-400">query(k,l,i,l) = |i-k|+1</script>.
      Besides, either <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-401-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>j</mi><mo>&amp;#x2212;</mo><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>&amp;#x00D7;</mo><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>i</mi><mo>&amp;#x2212;</mo><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3829" style="width: 13.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.503em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1012.39em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3830"><span class="texatom" id="MathJax-Span-3831"><span class="mrow" id="MathJax-Span-3832"><span class="mo" id="MathJax-Span-3833" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3834" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3835" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3836" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">l</span><span class="texatom" id="MathJax-Span-3837"><span class="mrow" id="MathJax-Span-3838"><span class="mo" id="MathJax-Span-3839" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3840" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3841" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span><span class="mo" id="MathJax-Span-3842" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="mn" id="MathJax-Span-3843" style="font-family: MathJax_Main; padding-left: 0.287em;">2</span><span class="mo" id="MathJax-Span-3844" style="font-family: MathJax_Main; padding-left: 0.23em;">×</span><span class="mo" id="MathJax-Span-3845" style="font-family: MathJax_Main; padding-left: 0.23em;">(</span><span class="texatom" id="MathJax-Span-3846"><span class="mrow" id="MathJax-Span-3847"><span class="mo" id="MathJax-Span-3848" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3849" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3850" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3851" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">k</span><span class="texatom" id="MathJax-Span-3852"><span class="mrow" id="MathJax-Span-3853"><span class="mo" id="MathJax-Span-3854" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3855" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3856" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span><span class="mo" id="MathJax-Span-3857" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>j</mi><mo>−</mo><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>×</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>i</mi><mo>−</mo><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-401">|j-l|+1 = 2 \times (|i-k|+1)</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-402-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>i</mi><mo>&amp;#x2212;</mo><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>&amp;#x00D7;</mo><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>j</mi><mo>&amp;#x2212;</mo><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3858" style="width: 13.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.503em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1012.39em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3859"><span class="texatom" id="MathJax-Span-3860"><span class="mrow" id="MathJax-Span-3861"><span class="mo" id="MathJax-Span-3862" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3863" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3864" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3865" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">k</span><span class="texatom" id="MathJax-Span-3866"><span class="mrow" id="MathJax-Span-3867"><span class="mo" id="MathJax-Span-3868" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3869" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3870" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span><span class="mo" id="MathJax-Span-3871" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="mn" id="MathJax-Span-3872" style="font-family: MathJax_Main; padding-left: 0.287em;">2</span><span class="mo" id="MathJax-Span-3873" style="font-family: MathJax_Main; padding-left: 0.23em;">×</span><span class="mo" id="MathJax-Span-3874" style="font-family: MathJax_Main; padding-left: 0.23em;">(</span><span class="texatom" id="MathJax-Span-3875"><span class="mrow" id="MathJax-Span-3876"><span class="mo" id="MathJax-Span-3877" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3878" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3879" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3880" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">l</span><span class="texatom" id="MathJax-Span-3881"><span class="mrow" id="MathJax-Span-3882"><span class="mo" id="MathJax-Span-3883" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3884" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3885" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span><span class="mo" id="MathJax-Span-3886" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>i</mi><mo>−</mo><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>×</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>j</mi><mo>−</mo><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-402">|i-k|+1= 2 \times (|j-l|+1)</script> should be true.
      If these conditions are satisfied, increase the answer by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-403-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3887" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1000.46em, 2.389em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3888"><span class="mn" id="MathJax-Span-3889" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-403">1</script>.
    </li>
    <li>
      For segments meeting at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-404-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3890" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.162em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1002.05em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3891"><span class="mo" id="MathJax-Span-3892" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3893" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3894" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3895" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-3896" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-404">(k,j)</script>, check that
      <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-405-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>i</mi><mo>&amp;#x2212;</mo><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3897" style="width: 13.185em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1011.93em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3898"><span class="mi" id="MathJax-Span-3899" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3900" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-3901" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3902" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-3903" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3904" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3905" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3906" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3907" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-3908" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3909" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">k</span><span class="mo" id="MathJax-Span-3910" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3911" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-3912" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3913" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="texatom" id="MathJax-Span-3914" style="padding-left: 0.287em;"><span class="mrow" id="MathJax-Span-3915"><span class="mo" id="MathJax-Span-3916" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3917" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3918" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3919" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">k</span><span class="texatom" id="MathJax-Span-3920"><span class="mrow" id="MathJax-Span-3921"><span class="mo" id="MathJax-Span-3922" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3923" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3924" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>i</mi><mo>−</mo><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-405">query(i,j,k,j) = |i-k|+1</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-406-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>j</mi><mo>&amp;#x2212;</mo><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3925" style="width: 13.128em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.935em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1011.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3926"><span class="mi" id="MathJax-Span-3927" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3928" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-3929" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3930" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-3931" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3932" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3933" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-3934" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3935" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mo" id="MathJax-Span-3936" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3937" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">k</span><span class="mo" id="MathJax-Span-3938" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3939" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-3940" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3941" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="texatom" id="MathJax-Span-3942" style="padding-left: 0.287em;"><span class="mrow" id="MathJax-Span-3943"><span class="mo" id="MathJax-Span-3944" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3945" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3946" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3947" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">l</span><span class="texatom" id="MathJax-Span-3948"><span class="mrow" id="MathJax-Span-3949"><span class="mo" id="MathJax-Span-3950" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3951" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3952" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mi>u</mi><mi>e</mi><mi>r</mi><mi>y</mi><mo stretchy="false">(</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>j</mi><mo>−</mo><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-406">query(k,l,k,j) = |j-l|+1</script>.
      Besides, either <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-407-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>i</mi><mo>&amp;#x2212;</mo><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>&amp;#x00D7;</mo><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>j</mi><mo>&amp;#x2212;</mo><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3953" style="width: 13.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.503em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1012.39em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3954"><span class="texatom" id="MathJax-Span-3955"><span class="mrow" id="MathJax-Span-3956"><span class="mo" id="MathJax-Span-3957" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3958" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3959" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3960" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">k</span><span class="texatom" id="MathJax-Span-3961"><span class="mrow" id="MathJax-Span-3962"><span class="mo" id="MathJax-Span-3963" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3964" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3965" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span><span class="mo" id="MathJax-Span-3966" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="mn" id="MathJax-Span-3967" style="font-family: MathJax_Main; padding-left: 0.287em;">2</span><span class="mo" id="MathJax-Span-3968" style="font-family: MathJax_Main; padding-left: 0.23em;">×</span><span class="mo" id="MathJax-Span-3969" style="font-family: MathJax_Main; padding-left: 0.23em;">(</span><span class="texatom" id="MathJax-Span-3970"><span class="mrow" id="MathJax-Span-3971"><span class="mo" id="MathJax-Span-3972" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3973" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3974" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3975" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">l</span><span class="texatom" id="MathJax-Span-3976"><span class="mrow" id="MathJax-Span-3977"><span class="mo" id="MathJax-Span-3978" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3979" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3980" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span><span class="mo" id="MathJax-Span-3981" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>i</mi><mo>−</mo><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>×</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>j</mi><mo>−</mo><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-407">|i-k|+1 = 2 \times (|j-l|+1)</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-408-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>j</mi><mo>&amp;#x2212;</mo><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>&amp;#x00D7;</mo><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>i</mi><mo>&amp;#x2212;</mo><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3982" style="width: 13.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.503em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1012.39em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-3983"><span class="texatom" id="MathJax-Span-3984"><span class="mrow" id="MathJax-Span-3985"><span class="mo" id="MathJax-Span-3986" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3987" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-3988" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-3989" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">l</span><span class="texatom" id="MathJax-Span-3990"><span class="mrow" id="MathJax-Span-3991"><span class="mo" id="MathJax-Span-3992" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-3993" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-3994" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span><span class="mo" id="MathJax-Span-3995" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="mn" id="MathJax-Span-3996" style="font-family: MathJax_Main; padding-left: 0.287em;">2</span><span class="mo" id="MathJax-Span-3997" style="font-family: MathJax_Main; padding-left: 0.23em;">×</span><span class="mo" id="MathJax-Span-3998" style="font-family: MathJax_Main; padding-left: 0.23em;">(</span><span class="texatom" id="MathJax-Span-3999"><span class="mrow" id="MathJax-Span-4000"><span class="mo" id="MathJax-Span-4001" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-4002" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4003" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-4004" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">k</span><span class="texatom" id="MathJax-Span-4005"><span class="mrow" id="MathJax-Span-4006"><span class="mo" id="MathJax-Span-4007" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-4008" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-4009" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span><span class="mo" id="MathJax-Span-4010" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>j</mi><mo>−</mo><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>×</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>i</mi><mo>−</mo><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-408">|j-l|+1= 2 \times (|i-k|+1)</script> should be true.
      If these conditions are satisfied, increase the answer by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-409-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4011" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1000.46em, 2.389em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4012"><span class="mn" id="MathJax-Span-4013" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-409">1</script>.
    </li>
  </ul>
<p></p>

<p>
  We can iterate over all possible end points of these two segments L-shape because there
  are <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-410-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msup><mo>&amp;#x00D7;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4014" style="width: 5.912em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.344em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.139em, 1005.23em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4015"><span class="mi" id="MathJax-Span-4016" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-4017" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4018"><span style="display: inline-block; position: relative; width: 1.31em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.86em, 4.151em, -999.997em); top: -3.974em; left: 0em;"><span class="texatom" id="MathJax-Span-4019"><span class="mrow" id="MathJax-Span-4020"><span class="mi" id="MathJax-Span-4021" style="font-family: MathJax_Main-bold;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.855em;"><span class="texatom" id="MathJax-Span-4022"><span class="mrow" id="MathJax-Span-4023"><span class="mn" id="MathJax-Span-4024" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4025" style="font-family: MathJax_Main; padding-left: 0.23em;">×</span><span class="msubsup" id="MathJax-Span-4026" style="padding-left: 0.23em;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.74em, 4.151em, -999.997em); top: -3.974em; left: 0em;"><span class="texatom" id="MathJax-Span-4027"><span class="mrow" id="MathJax-Span-4028"><span class="mi" id="MathJax-Span-4029" style="font-family: MathJax_Main-bold;">C</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.855em;"><span class="texatom" id="MathJax-Span-4030"><span class="mrow" id="MathJax-Span-4031"><span class="mn" id="MathJax-Span-4032" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4033" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><mo>×</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-410">O(\mathbf{R}^{2} \times \mathbf{C}^{2})</script> such possible combinations. We can calculate the number of possible L-shapes with these end points in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-411-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4034" style="width: 2.276em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.048em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.93em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4035"><span class="mi" id="MathJax-Span-4036" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-4037" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-4038" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-4039" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-411">O(1)</script>. Hence, the overall complexity of the solution is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-412-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msup><mo>&amp;#x00D7;</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4040" style="width: 5.912em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.344em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.139em, 1005.23em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4041"><span class="mi" id="MathJax-Span-4042" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-4043" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-4044"><span style="display: inline-block; position: relative; width: 1.31em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.86em, 4.151em, -999.997em); top: -3.974em; left: 0em;"><span class="texatom" id="MathJax-Span-4045"><span class="mrow" id="MathJax-Span-4046"><span class="mi" id="MathJax-Span-4047" style="font-family: MathJax_Main-bold;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.855em;"><span class="texatom" id="MathJax-Span-4048"><span class="mrow" id="MathJax-Span-4049"><span class="mn" id="MathJax-Span-4050" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4051" style="font-family: MathJax_Main; padding-left: 0.23em;">×</span><span class="msubsup" id="MathJax-Span-4052" style="padding-left: 0.23em;"><span style="display: inline-block; position: relative; width: 1.253em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.74em, 4.151em, -999.997em); top: -3.974em; left: 0em;"><span class="texatom" id="MathJax-Span-4053"><span class="mrow" id="MathJax-Span-4054"><span class="mi" id="MathJax-Span-4055" style="font-family: MathJax_Main-bold;">C</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.855em;"><span class="texatom" id="MathJax-Span-4056"><span class="mrow" id="MathJax-Span-4057"><span class="mn" id="MathJax-Span-4058" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-4059" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><mo>×</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-412">O(\mathbf{R}^{2} \times \mathbf{C}^{2})</script>.
</p>

<h3>Test set 2</h3>
<p>
  We cannot iterate over all possible end points of the segments for this test set as the solution
  would time out. If for each cell, we can quickly calculate how many L-shapes are such that both of its segments
meet at this cell, we can iterate over each cell of the matrix only once and calculate our answer. We can safely ignore those cells that
have value 0 as they cannot be part of any L-shape.
</p>

<p>
Consider a cell <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-413-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4060" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4061"><span class="mo" id="MathJax-Span-4062" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4063" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4064" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4065" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4066" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-413">(i,j)</script>.
There can be 4 types of L-shapes that have both of its segments meet this cell.
</p><ul>
  <li>Type 1: One of the segments is to top of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-414-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4067" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4068"><span class="mo" id="MathJax-Span-4069" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4070" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4071" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4072" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4073" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-414">(i,j)</script>, and other segment is to the right of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-415-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4074" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4075"><span class="mo" id="MathJax-Span-4076" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4077" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4078" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4079" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4080" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-415">(i,j)</script>.</li>
  <li>Type 2: One of the segments is to top of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-416-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4081" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4082"><span class="mo" id="MathJax-Span-4083" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4084" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4085" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4086" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4087" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-416">(i,j)</script>, and other segment is to the left of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-417-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4088" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4089"><span class="mo" id="MathJax-Span-4090" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4091" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4092" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4093" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4094" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-417">(i,j)</script>.</li>
  <li>Type 3: One of the segments is to bottom of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-418-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4095" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4096"><span class="mo" id="MathJax-Span-4097" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4098" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4099" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4100" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4101" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-418">(i,j)</script>, and other segment is to the right of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-419-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4102" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4103"><span class="mo" id="MathJax-Span-4104" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4105" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4106" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4107" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4108" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-419">(i,j)</script>.</li>
  <li>Type 4: One of the segments is to bottom of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-420-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4109" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4110"><span class="mo" id="MathJax-Span-4111" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4112" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4113" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4114" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4115" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-420">(i,j)</script>, and other segment is to the left of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-421-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4116" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4117"><span class="mo" id="MathJax-Span-4118" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4119" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4120" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4121" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4122" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-421">(i,j)</script>.</li>
</ul>

<p></p>

<p>
  Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-422-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4123" style="width: 5.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.116em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1005em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4124"><span class="mi" id="MathJax-Span-4125" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4126" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4127" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4128" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4129" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4130" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4131" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-4132" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4133" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4134" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-422">Count(x,y)</script> be the number of L-shapes with both its segments meeting at a particular point of which the length of the segment
  parallel to one axis is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-423-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4135" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.537em, 1000.51em, 2.332em, -999.997em); top: -2.156em; left: 0em;"><span class="mrow" id="MathJax-Span-4136"><span class="mi" id="MathJax-Span-4137" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-423">x</script>
  and the length of the segment parallel to the other axis is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-424-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4138" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.537em, 1000.51em, 2.56em, -999.997em); top: -2.156em; left: 0em;"><span class="mrow" id="MathJax-Span-4139"><span class="mi" id="MathJax-Span-4140" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-424">y</script>. Number of L-shapes with longer segment as part of the segment with length <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-425-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4141" style="width: 0.628em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.537em, 1000.51em, 2.332em, -999.997em); top: -2.156em; left: 0em;"><span class="mrow" id="MathJax-Span-4142"><span class="mi" id="MathJax-Span-4143" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-425">x</script> are
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-426-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>(</mo><mfrac><mi>x</mi><mn>2</mn></mfrac><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4144" style="width: 6.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.026em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1005.97em, 2.787em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4145"><span class="mi" id="MathJax-Span-4146" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-4147" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4148" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-4149" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-4150"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; margin-right: 0.116em; margin-left: 0.116em;"><span style="position: absolute; clip: rect(3.469em, 1000.34em, 4.151em, -999.997em); top: -4.372em; left: 50%; margin-left: -0.224em;"><span class="mi" id="MathJax-Span-4151" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.355em, 1000.34em, 4.151em, -999.997em); top: -3.577em; left: 50%; margin-left: -0.168em;"><span class="mn" id="MathJax-Span-4152" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.855em, 1000.51em, 1.253em, -999.997em); top: -1.304em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.514em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-4153" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4154" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4155" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4156" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mn" id="MathJax-Span-4157" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mfrac><mi>x</mi><mn>2</mn></mfrac><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-426">min(\frac{x}{2},y) - 1</script>. Similarly, number of L-shapes with longer segment as part of the segment with length <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-427-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4158" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.537em, 1000.51em, 2.56em, -999.997em); top: -2.156em; left: 0em;"><span class="mrow" id="MathJax-Span-4159"><span class="mi" id="MathJax-Span-4160" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-427">y</script> are
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-428-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>(</mo><mfrac><mi>y</mi><mn>2</mn></mfrac><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4161" style="width: 6.707em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.082em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.196em, 1006.03em, 2.787em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4162"><span class="mi" id="MathJax-Span-4163" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-4164" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4165" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-4166" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-4167"><span style="display: inline-block; position: relative; width: 0.457em; height: 0px; margin-right: 0.116em; margin-left: 0.116em;"><span style="position: absolute; clip: rect(3.469em, 1000.34em, 4.321em, -999.997em); top: -4.543em; left: 50%; margin-left: -0.168em;"><span class="mi" id="MathJax-Span-4168" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.355em, 1000.34em, 4.151em, -999.997em); top: -3.577em; left: 50%; margin-left: -0.168em;"><span class="mn" id="MathJax-Span-4169" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.855em, 1000.46em, 1.253em, -999.997em); top: -1.304em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.457em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-4170" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4171" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">x</span><span class="mo" id="MathJax-Span-4172" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4173" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mn" id="MathJax-Span-4174" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mfrac><mi>y</mi><mn>2</mn></mfrac><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-428">min(\frac{y}{2},x) - 1</script>. Hence, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-429-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>(</mo><mfrac><mi>x</mi><mn>2</mn></mfrac><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy=&quot;false&quot;>(</mo><mfrac><mi>y</mi><mn>2</mn></mfrac><mo>,</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4175" style="width: 19.832em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.014em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.196em, 1017.96em, 2.787em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4176"><span class="mi" id="MathJax-Span-4177" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4178" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4179" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4180" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4181" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4182" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4183" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-4184" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4185" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4186" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4187" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="mi" id="MathJax-Span-4188" style="font-family: MathJax_Math-italic; padding-left: 0.287em;">m</span><span class="mi" id="MathJax-Span-4189" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4190" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-4191" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-4192"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; margin-right: 0.116em; margin-left: 0.116em;"><span style="position: absolute; clip: rect(3.469em, 1000.34em, 4.151em, -999.997em); top: -4.372em; left: 50%; margin-left: -0.224em;"><span class="mi" id="MathJax-Span-4193" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.355em, 1000.34em, 4.151em, -999.997em); top: -3.577em; left: 50%; margin-left: -0.168em;"><span class="mn" id="MathJax-Span-4194" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.855em, 1000.51em, 1.253em, -999.997em); top: -1.304em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.514em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-4195" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4196" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-4197" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4198" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mi" id="MathJax-Span-4199" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">m</span><span class="mi" id="MathJax-Span-4200" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4201" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-4202" style="font-family: MathJax_Main;">(</span><span class="mfrac" id="MathJax-Span-4203"><span style="display: inline-block; position: relative; width: 0.457em; height: 0px; margin-right: 0.116em; margin-left: 0.116em;"><span style="position: absolute; clip: rect(3.469em, 1000.34em, 4.321em, -999.997em); top: -4.543em; left: 50%; margin-left: -0.168em;"><span class="mi" id="MathJax-Span-4204" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.355em, 1000.34em, 4.151em, -999.997em); top: -3.577em; left: 50%; margin-left: -0.168em;"><span class="mn" id="MathJax-Span-4205" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.855em, 1000.46em, 1.253em, -999.997em); top: -1.304em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.457em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.082em;"></span></span></span></span><span class="mo" id="MathJax-Span-4206" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4207" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">x</span><span class="mo" id="MathJax-Span-4208" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4209" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mn" id="MathJax-Span-4210" style="font-family: MathJax_Main; padding-left: 0.23em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mfrac><mi>x</mi><mn>2</mn></mfrac><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mfrac><mi>y</mi><mn>2</mn></mfrac><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-429">Count(x,y) = min(\frac{x}{2},y) + min(\frac{y}{2},x) - 2</script>.
</p>

<p>
If we can calculate number of consecutive cells that have value 1 in each side of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-430-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4211" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4212"><span class="mo" id="MathJax-Span-4213" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4214" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4215" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4216" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4217" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-430">(i,j)</script>, we can calculate number of L-shapes of each type with this cell as the common endpoint of the segments using the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-431-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4218" style="width: 3.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.582em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1003.47em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4219"><span class="mi" id="MathJax-Span-4220" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4221" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4222" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4223" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4224" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4225" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-4226" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-431">Count()</script> function above.
Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-432-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4227" style="width: 3.696em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.355em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1003.24em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4228"><span class="mi" id="MathJax-Span-4229" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4230" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4231" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-4232" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4233" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4234" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4235" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4236" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-432">top(i,j)</script> denote the number of consecutive cells that have value 1 including <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-433-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4237" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4238"><span class="mo" id="MathJax-Span-4239" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4240" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4241" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4242" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4243" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-433">(i,j)</script> and cells above it. For cells with value 0,
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-434-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>0</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4244" style="width: 5.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.173em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1005.12em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4245"><span class="mi" id="MathJax-Span-4246" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4247" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4248" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-4249" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4250" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4251" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4252" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4253" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4254" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="mn" id="MathJax-Span-4255" style="font-family: MathJax_Main; padding-left: 0.287em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-434">top(i,j) = 0</script>.
Formally for cells with value 1, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-435-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>i</mi><mo>&amp;#x2212;</mo><mi>k</mi><mo>+</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4256" style="width: 9.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.526em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1008.47em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4257"><span class="mi" id="MathJax-Span-4258" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4259" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4260" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-4261" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4262" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4263" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4264" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4265" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4266" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="mi" id="MathJax-Span-4267" style="font-family: MathJax_Math-italic; padding-left: 0.287em;">i</span><span class="mo" id="MathJax-Span-4268" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mi" id="MathJax-Span-4269" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">k</span><span class="mo" id="MathJax-Span-4270" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-4271" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mi>i</mi><mo>−</mo><mi>k</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-435">top(i,j) = i - k + 1</script> where
<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-436-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2264;</mo><mi>k</mi><mo>&amp;#x2264;</mo><mi>i</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4272" style="width: 4.491em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.094em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1004.04em, 2.503em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4273"><span class="mn" id="MathJax-Span-4274" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-4275" style="font-family: MathJax_Main; padding-left: 0.287em;">≤</span><span class="mi" id="MathJax-Span-4276" style="font-family: MathJax_Math-italic; padding-left: 0.287em;">k</span><span class="mo" id="MathJax-Span-4277" style="font-family: MathJax_Main; padding-left: 0.287em;">≤</span><span class="mi" id="MathJax-Span-4278" style="font-family: MathJax_Math-italic; padding-left: 0.287em;">i</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-436">1 \le k \le i</script> and k is least possible value such that all cells from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-437-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4279" style="width: 2.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.162em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1002.05em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4280"><span class="mo" id="MathJax-Span-4281" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4282" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-4283" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4284" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4285" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-437">(k,j)</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-438-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4286" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4287"><span class="mo" id="MathJax-Span-4288" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4289" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4290" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4291" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4292" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-438">(i,j)</script> have value 1.
Similarly, we can define <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-439-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4293" style="width: 5.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.003em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1004.89em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4294"><span class="mi" id="MathJax-Span-4295" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-4296" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4297" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4298" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4299" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4300" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-4301" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4302" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4303" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4304" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4305" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-439">bottom(i,j)</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-440-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4306" style="width: 4.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.639em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1003.53em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4307"><span class="mi" id="MathJax-Span-4308" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-4309" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-4310" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4311" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4312" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4313" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4314" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4315" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4316" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-440">left(i,j)</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-441-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4317" style="width: 4.662em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.207em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1004.09em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4318"><span class="mi" id="MathJax-Span-4319" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-4320" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4321" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4322" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-4323" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4324" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4325" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4326" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4327" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4328" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-441">right(i,j)</script> denoting maximum number
of consecutive cells on bottom, left and right of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-442-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4329" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4330"><span class="mo" id="MathJax-Span-4331" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4332" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4333" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4334" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4335" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-442">(i,j)</script> respectively.
</p>

<p>
  We can calculate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-443-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4336" style="width: 3.696em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.355em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1003.24em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4337"><span class="mi" id="MathJax-Span-4338" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4339" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4340" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-4341" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4342" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4343" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4344" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4345" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-443">top(i,j)</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-444-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4346" style="width: 4.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.639em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1003.53em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4347"><span class="mi" id="MathJax-Span-4348" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-4349" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-4350" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4351" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4352" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4353" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4354" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4355" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4356" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-444">left(i,j)</script> by iterating from the starting of the matrix and updating their values. Refer to the code
  below to calculate these values.
</p>

<pre><code class="language-cpp">
  for(<var>int</var> i = 1; i &lt;= R; i++) {
    for(<var>int</var> j = 1; j &lt;= C; j++) {
       if (matrix[i][j] == 0) continue;
       top[i][j] = top[i - 1][j] + 1;
       left[i][j] = left[i][j - 1] + 1;
    }
 }

</code></pre>

<p>
  Similarly, we can calculate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-445-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4357" style="width: 5.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.003em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1004.89em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4358"><span class="mi" id="MathJax-Span-4359" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-4360" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4361" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4362" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4363" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4364" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-4365" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4366" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4367" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4368" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4369" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-445">bottom(i,j)</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-446-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4370" style="width: 4.662em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.207em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1004.09em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4371"><span class="mi" id="MathJax-Span-4372" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-4373" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4374" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4375" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-4376" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4377" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4378" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4379" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4380" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4381" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-446">right(i,j)</script> by iterating from the end of
  the matrix. After knowing these values, we can calculate number of L-shapes of each type for
  cell <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-447-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4382" style="width: 2.219em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.991em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.88em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4383"><span class="mo" id="MathJax-Span-4384" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4385" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4386" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4387" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4388" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-447">(i,j)</script>. <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-448-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4389" style="width: 12.787em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.594em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1011.48em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4390"><span class="mi" id="MathJax-Span-4391" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4392" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4393" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4394" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4395" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4396" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4397" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4398" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4399" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-4400" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4401" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4402" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4403" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4404" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4405" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4406" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">r</span><span class="mi" id="MathJax-Span-4407" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4408" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4409" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-4410" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4411" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4412" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4413" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4414" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4415" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4416" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-448">Count(top(i,j), right(i,j))</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-449-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4417" style="width: 12.162em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.026em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1010.91em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4418"><span class="mi" id="MathJax-Span-4419" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4420" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4421" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4422" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4423" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4424" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4425" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4426" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4427" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-4428" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4429" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4430" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4431" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4432" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4433" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4434" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mi" id="MathJax-Span-4435" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-4436" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4437" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4438" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4439" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4440" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4441" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4442" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4443" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-449">Count(top(i,j), left(i,j))</script>,
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-450-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4444" style="width: 14.605em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.241em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1013.13em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4445"><span class="mi" id="MathJax-Span-4446" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4447" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4448" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4449" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4450" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4451" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4452" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-4453" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4454" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4455" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4456" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4457" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-4458" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4459" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4460" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4461" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4462" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4463" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4464" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">r</span><span class="mi" id="MathJax-Span-4465" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4466" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4467" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-4468" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4469" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4470" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4471" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4472" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4473" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4474" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-450">Count(bottom(i,j), right(i,j))</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-451-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4475" style="width: 13.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.673em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1012.56em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4476"><span class="mi" id="MathJax-Span-4477" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4478" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4479" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4480" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4481" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4482" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4483" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-4484" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4485" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4486" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4487" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4488" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-4489" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4490" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4491" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4492" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4493" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4494" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4495" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mi" id="MathJax-Span-4496" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-4497" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4498" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4499" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4500" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4501" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4502" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4503" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4504" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-451">Count(bottom(i,j), left(i,j))</script> denote the number of L-shapes of type 1, 2, 3 and 4
  respectively. Thus, for each cell we can add <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-452-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4505" style="width: 57.446em; display: inline-block;"><span style="display: inline-block; position: relative; width: 52.219em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1052.11em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4506"><span class="mi" id="MathJax-Span-4507" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4508" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4509" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4510" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4511" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4512" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4513" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4514" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4515" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-4516" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4517" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4518" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4519" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4520" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4521" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4522" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mi" id="MathJax-Span-4523" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-4524" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4525" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4526" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4527" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4528" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4529" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4530" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4531" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4532" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mi" id="MathJax-Span-4533" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4534" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4535" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4536" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4537" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4538" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4539" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4540" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4541" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-4542" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4543" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4544" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4545" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4546" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4547" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4548" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">r</span><span class="mi" id="MathJax-Span-4549" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4550" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4551" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-4552" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4553" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4554" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4555" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4556" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4557" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4558" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4559" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mi" id="MathJax-Span-4560" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4561" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4562" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4563" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4564" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4565" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4566" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-4567" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4568" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4569" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4570" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4571" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-4572" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4573" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4574" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4575" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4576" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4577" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4578" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">l</span><span class="mi" id="MathJax-Span-4579" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-4580" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4581" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4582" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4583" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4584" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4585" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4586" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4587" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4588" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mi" id="MathJax-Span-4589" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4590" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4591" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4592" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4593" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4594" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4595" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-4596" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4597" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4598" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4599" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4600" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-4601" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4602" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4603" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4604" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4605" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4606" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4607" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">r</span><span class="mi" id="MathJax-Span-4608" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4609" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4610" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-4611" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4612" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4613" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4614" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4615" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4616" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-4617" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>,</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-452">Count(top(i,j), left(i,j)) + Count(top(i,j), right(i,j))
  + Count(bottom(i,j), left(i,j)) + Count(bottom(i,j), right(i,j))</script> to the answer.
</p>

<p>
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-453-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4618" style="width: 3.696em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.355em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1003.24em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4619"><span class="mi" id="MathJax-Span-4620" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4621" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4622" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-4623" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4624" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4625" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4626" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4627" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mi>o</mi><mi>p</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-453">top(i,j)</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-454-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4628" style="width: 5.514em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.003em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1004.89em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4629"><span class="mi" id="MathJax-Span-4630" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-4631" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4632" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4633" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-4634" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4635" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-4636" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4637" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4638" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4639" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4640" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mi>o</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>m</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-454">bottom(i,j)</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-455-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4641" style="width: 4.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.639em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1003.53em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4642"><span class="mi" id="MathJax-Span-4643" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-4644" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-4645" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4646" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4647" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4648" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4649" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4650" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4651" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-455">left(i,j)</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-456-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4652" style="width: 4.662em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.207em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1004.09em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4653"><span class="mi" id="MathJax-Span-4654" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-4655" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-4656" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4657" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-4658" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4659" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4660" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4661" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4662" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4663" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-456">right(i,j)</script> can be calculated in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-457-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x00D7;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4664" style="width: 4.946em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.491em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1004.38em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4665"><span class="mi" id="MathJax-Span-4666" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-4667" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-4668"><span class="mrow" id="MathJax-Span-4669"><span class="mi" id="MathJax-Span-4670" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-4671" style="font-family: MathJax_Main; padding-left: 0.23em;">×</span><span class="texatom" id="MathJax-Span-4672" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-4673"><span class="mi" id="MathJax-Span-4674" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-4675" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-457">O(\mathbf{R} \times \mathbf{C})</script> time complexity.
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-458-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4676" style="width: 5.287em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.776em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1004.66em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4677"><span class="mi" id="MathJax-Span-4678" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-4679" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-4680" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-4681" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-4682" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-4683" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4684" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-4685" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-4686" style="font-family: MathJax_Math-italic; padding-left: 0.173em;">j</span><span class="mo" id="MathJax-Span-4687" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-458">Count(i,j)</script> can be calculate in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-459-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x00D7;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4688" style="width: 4.946em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.491em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1004.38em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4689"><span class="mi" id="MathJax-Span-4690" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-4691" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-4692"><span class="mrow" id="MathJax-Span-4693"><span class="mi" id="MathJax-Span-4694" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-4695" style="font-family: MathJax_Main; padding-left: 0.23em;">×</span><span class="texatom" id="MathJax-Span-4696" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-4697"><span class="mi" id="MathJax-Span-4698" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-4699" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-459">O(\mathbf{R} \times \mathbf{C})</script> time complexity. Finally, we need to iterate over each cell of the matrix, and we
  can update the answer in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-460-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4700" style="width: 2.276em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.048em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.93em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-4701"><span class="mi" id="MathJax-Span-4702" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-4703" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-4704" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-4705" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-460">O(1)</script> for each cell. Thus, the overall complexity of the solution is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-461-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x00D7;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4706" style="width: 4.946em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.491em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1004.38em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-4707"><span class="mi" id="MathJax-Span-4708" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-4709" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-4710"><span class="mrow" id="MathJax-Span-4711"><span class="mi" id="MathJax-Span-4712" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-4713" style="font-family: MathJax_Main; padding-left: 0.23em;">×</span><span class="texatom" id="MathJax-Span-4714" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-4715"><span class="mi" id="MathJax-Span-4716" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-4717" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>×</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-461">O(\mathbf{R} \times \mathbf{C})</script>.
</p>

</p></div></div>
