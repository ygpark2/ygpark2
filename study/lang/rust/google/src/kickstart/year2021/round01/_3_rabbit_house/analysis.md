<div class="problem-analysis"><div class="problem-analysis-header"><h4 class="header-4">Analysis</h4></div> <div class="problem-description"><p><p>
  Barbara is given a 2D grid with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-527-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5207" style="width: 0.969em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.423em, 1000.86em, 2.446em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5208"><span class="texatom" id="MathJax-Span-5209"><span class="mrow" id="MathJax-Span-5210"><span class="mi" id="MathJax-Span-5211" style="font-family: MathJax_Main-bold;">R</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-527">\mathbf{R}</script> rows and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-528-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5212" style="width: 0.969em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.423em, 1000.8em, 2.446em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5213"><span class="texatom" id="MathJax-Span-5214"><span class="mrow" id="MathJax-Span-5215"><span class="mi" id="MathJax-Span-5216" style="font-family: MathJax_Main-bold;">C</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-528">\mathbf{C}</script> columns. Her goal is to create a grid
  such that no two adjacent cells have an absolute difference in height greater than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-529-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5217" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1000.46em, 2.389em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-5218"><span class="mn" id="MathJax-Span-5219" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-529">1</script>. Moreover,
  she is only allowed to increase the height of cells.
</p>
<p>
  We notice that the cell initially with the largest height (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-530-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5220" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.912em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1000.91em, 2.332em, -999.997em); top: -2.156em; left: 0em;"><span class="mrow" id="MathJax-Span-5221"><span class="mi" id="MathJax-Span-5222" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-530">H</script>) never requires increasing.
  Furthermore, Barbara can update its neighbor cells to have a height of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-531-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5223" style="width: 2.901em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.616em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1002.56em, 2.446em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-5224"><span class="mi" id="MathJax-Span-5225" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-5226" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mn" id="MathJax-Span-5227" style="font-family: MathJax_Main; padding-left: 0.23em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-531">H - 1</script> (unless they
  already have a height of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-532-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5228" style="width: 1.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.912em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1000.91em, 2.332em, -999.997em); top: -2.156em; left: 0em;"><span class="mrow" id="MathJax-Span-5229"><span class="mi" id="MathJax-Span-5230" style="font-family: MathJax_Math-italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-532">H</script>). Afterwards, she can repeat the process for the cell with the
  next largest height, until she visits all the cells.
</p>
<p>
  One thing to be careful of in this problem is that the final result can be larger than the limits
  of a 32-bit integer. Using 64-bit integers avoids WAs due to overflow.
</p>

<h3>Test set 1</h3>
<p>
  For this test set, Barbara sees that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-533-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2264;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo>&amp;#x2264;</mo><mn>50</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5231" style="width: 6.991em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.366em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.423em, 1006.31em, 2.616em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5232"><span class="mn" id="MathJax-Span-5233" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-5234" style="font-family: MathJax_Main; padding-left: 0.287em;">≤</span><span class="texatom" id="MathJax-Span-5235" style="padding-left: 0.287em;"><span class="mrow" id="MathJax-Span-5236"><span class="mi" id="MathJax-Span-5237" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5238" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-5239" style="padding-left: 0.173em;"><span class="mrow" id="MathJax-Span-5240"><span class="mi" id="MathJax-Span-5241" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5242" style="font-family: MathJax_Main; padding-left: 0.287em;">≤</span><span class="mn" id="MathJax-Span-5243" style="font-family: MathJax_Main; padding-left: 0.287em;">50</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo>≤</mo><mn>50</mn></math></span></span><script type="math/tex" id="MathJax-Element-533">1 \le \mathbf{R}, \mathbf{C} \le 50</script>. Therefore, she performs a
  linear scan over the grid to find the cell with the largest height. Then, she updates the height
  of its neighbors, and increments the result to account for the increase in height.
</p>
<p>
  Finally, she marks this cell as visited, which can be done via a secondary 2D grid of booleans.
  She repeats the above process until all cells have been visited, and return the result.
</p>
<p>
  The linear scan can be done in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-534-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5244" style="width: 4.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.98em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1003.87em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5245"><span class="mi" id="MathJax-Span-5246" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5247" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5248"><span class="mrow" id="MathJax-Span-5249"><span class="mi" id="MathJax-Span-5250" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5251" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5252" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5253"><span class="mi" id="MathJax-Span-5254" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5255" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-534">O(\mathbf{R} \cdot \mathbf{C})</script>, and Barbara visits each cell exactly once, so she
  performs the linear scan <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-535-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5256" style="width: 4.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.98em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1003.87em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5257"><span class="mi" id="MathJax-Span-5258" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5259" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5260"><span class="mrow" id="MathJax-Span-5261"><span class="mi" id="MathJax-Span-5262" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5263" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5264" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5265"><span class="mi" id="MathJax-Span-5266" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5267" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-535">O(\mathbf{R} \cdot \mathbf{C})</script> times. The overall time complexity is therefore
  <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-536-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5268" style="width: 5.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.173em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.253em, 1005.06em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5269"><span class="mi" id="MathJax-Span-5270" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5271" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-5272" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5273"><span class="mrow" id="MathJax-Span-5274"><span class="mi" id="MathJax-Span-5275" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5276" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5277" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5278"><span class="mi" id="MathJax-Span-5279" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="msubsup" id="MathJax-Span-5280"><span style="display: inline-block; position: relative; width: 0.798em; height: 0px;"><span style="position: absolute; clip: rect(3.071em, 1000.29em, 4.378em, -999.997em); top: -3.974em; left: 0em;"><span class="mo" id="MathJax-Span-5281" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.315em; left: 0.401em;"><span class="mn" id="MathJax-Span-5282" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-5283" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-536">O((\mathbf{R} \cdot \mathbf{C})^2)</script>. This fits within the limits of the small test set.<br>
  The additional space complexity is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-537-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5284" style="width: 4.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.98em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1003.87em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5285"><span class="mi" id="MathJax-Span-5286" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5287" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5288"><span class="mrow" id="MathJax-Span-5289"><span class="mi" id="MathJax-Span-5290" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5291" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5292" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5293"><span class="mi" id="MathJax-Span-5294" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5295" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-537">O(\mathbf{R} \cdot \mathbf{C})</script> due to the secondary 2D grid of
  booleans.
</p>

<h3>Test set 2</h3>
<p>
  For this test set, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-538-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2264;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo>&amp;#x2264;</mo><mn>300</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5296" style="width: 7.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.878em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.423em, 1006.82em, 2.616em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5297"><span class="mn" id="MathJax-Span-5298" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-5299" style="font-family: MathJax_Main; padding-left: 0.287em;">≤</span><span class="texatom" id="MathJax-Span-5300" style="padding-left: 0.287em;"><span class="mrow" id="MathJax-Span-5301"><span class="mi" id="MathJax-Span-5302" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5303" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-5304" style="padding-left: 0.173em;"><span class="mrow" id="MathJax-Span-5305"><span class="mi" id="MathJax-Span-5306" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5307" style="font-family: MathJax_Main; padding-left: 0.287em;">≤</span><span class="mn" id="MathJax-Span-5308" style="font-family: MathJax_Main; padding-left: 0.287em;">300</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo>≤</mo><mn>300</mn></math></span></span><script type="math/tex" id="MathJax-Element-538">1 \le \mathbf{R}, \mathbf{C} \le 300</script>. A time complexity of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-539-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5309" style="width: 5.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.173em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.253em, 1005.06em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5310"><span class="mi" id="MathJax-Span-5311" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5312" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-5313" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5314"><span class="mrow" id="MathJax-Span-5315"><span class="mi" id="MathJax-Span-5316" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5317" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5318" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5319"><span class="mi" id="MathJax-Span-5320" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="msubsup" id="MathJax-Span-5321"><span style="display: inline-block; position: relative; width: 0.798em; height: 0px;"><span style="position: absolute; clip: rect(3.071em, 1000.29em, 4.378em, -999.997em); top: -3.974em; left: 0em;"><span class="mo" id="MathJax-Span-5322" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.315em; left: 0.401em;"><span class="mn" id="MathJax-Span-5323" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-5324" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-539">O((\mathbf{R} \cdot \mathbf{C})^2)</script>
  will not satisfy the time limits.
</p>
<p>
  Barbara still needs to visit the unvisited cell with the largest height in each iteration. However, this
  can be done in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-540-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5325" style="width: 6.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.026em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1005.91em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5326"><span class="mi" id="MathJax-Span-5327" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5328" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5329" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-5330"></span><span class="mo" id="MathJax-Span-5331" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5332"><span class="mrow" id="MathJax-Span-5333"><span class="mi" id="MathJax-Span-5334" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5335" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5336" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5337"><span class="mi" id="MathJax-Span-5338" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5339" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5340" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-540">O(\log(\mathbf{R} \cdot \mathbf{C}))</script> using a priority queue. In each iteration, she pops the
  cell with the largest height, updates the height of its neighbors in the priority queue, and
  increments the result.
</p>
<p>
  The time complexity of the above solution is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-541-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo>&amp;#x22C5;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5341" style="width: 10.116em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.207em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1009.09em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5342"><span class="mi" id="MathJax-Span-5343" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5344" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5345"><span class="mrow" id="MathJax-Span-5346"><span class="mi" id="MathJax-Span-5347" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5348" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5349" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5350"><span class="mi" id="MathJax-Span-5351" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5352" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="mi" id="MathJax-Span-5353" style="font-family: MathJax_Main; padding-left: 0.23em;">log</span><span class="mo" id="MathJax-Span-5354"></span><span class="mo" id="MathJax-Span-5355" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5356"><span class="mrow" id="MathJax-Span-5357"><span class="mi" id="MathJax-Span-5358" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5359" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5360" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5361"><span class="mi" id="MathJax-Span-5362" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5363" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5364" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-541">O(\mathbf{R} \cdot \mathbf{C} \cdot \log(\mathbf{R} \cdot \mathbf{C}))</script>. The
  additional space complexity is still <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-542-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5365" style="width: 4.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.98em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1003.87em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5366"><span class="mi" id="MathJax-Span-5367" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5368" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5369"><span class="mrow" id="MathJax-Span-5370"><span class="mi" id="MathJax-Span-5371" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5372" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5373" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5374"><span class="mi" id="MathJax-Span-5375" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5376" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-542">O(\mathbf{R} \cdot \mathbf{C})</script>, since initially the priority queue
  contains all the cells.
</p>
<p>
  Note that, depending on the implementation, updating a non-top element in the priority queue might
  not be an <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-543-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5377" style="width: 2.276em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.048em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.93em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-5378"><span class="mi" id="MathJax-Span-5379" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5380" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-5381" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-5382" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-543">O(1)</script> operation. In such cases, one trick would be to insert a new element into the
  queue with the new height, and update the height in the grid. On processing any element, check
  whether the height in the queue corresponds to the height in the grid, and ignore the element
  otherwise. This does not change the worst-case time and space complexity, since the maximum number
  of times a cell can be added to the queue is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-544-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>4</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5383" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.514em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1000.46em, 2.389em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-5384"><span class="mn" id="MathJax-Span-5385" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-544">4</script>.
</p>

<h3>Further Improvements</h3>
<p>
  While not necessary to pass the time limits, the time complexity can be reduced further.
</p>
<p>
  One approach is to replace the priority queue with a list of buckets, each bucket containing a set
  of cells with a given height. With this approach, Barbara can iterate over the buckets in decreasing
  order of height in order to visit each cell, then apply the same algorithm as above: update the
  neighbors (by placing them in their new buckets according to their new height), and remove the
  visited cells from the list.
</p>
<p>
  By using a hashset for each bucket, insertion and removal becomes an <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-545-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5386" style="width: 2.276em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.048em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.93em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-5387"><span class="mi" id="MathJax-Span-5388" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5389" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-5390" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-5391" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-545">O(1)</script> operation. She can
  also use a vector. However, the trick from Test Set 2 is needed to maintain an <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-546-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5392" style="width: 2.276em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.048em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1001.93em, 2.616em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-5393"><span class="mi" id="MathJax-Span-5394" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5395" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-5396" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-5397" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-546">O(1)</script>
  insertion/removal in that case. Iterating over the buckets is linear in the number of buckets, and
  she will visit at most <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-547-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5398" style="width: 4.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.98em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1003.87em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5399"><span class="mi" id="MathJax-Span-5400" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5401" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5402"><span class="mrow" id="MathJax-Span-5403"><span class="mi" id="MathJax-Span-5404" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5405" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5406" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5407"><span class="mi" id="MathJax-Span-5408" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5409" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-547">O(\mathbf{R} \cdot \mathbf{C})</script> cells.
</p>
<p>
  Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-548-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi mathvariant=&quot;bold&quot;>G</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>i</mi><mo mathvariant=&quot;bold&quot;>,</mo><mi mathvariant=&quot;bold&quot;>j</mi></mrow></msub></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5410" style="width: 7.162em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.48em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1006.37em, 2.673em, -999.997em); top: -2.213em; left: 0em;"><span class="mrow" id="MathJax-Span-5411"><span class="mi" id="MathJax-Span-5412" style="font-family: MathJax_Math-italic;">G</span><span class="mo" id="MathJax-Span-5413" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="mo" id="MathJax-Span-5414" style="font-family: MathJax_Main; padding-left: 0.287em;">max</span><span class="mo" id="MathJax-Span-5415" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5416"><span class="mrow" id="MathJax-Span-5417"><span class="msubsup" id="MathJax-Span-5418"><span style="display: inline-block; position: relative; width: 1.707em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.86em, 4.151em, -999.997em); top: -3.974em; left: 0em;"><span class="mi" id="MathJax-Span-5419" style="font-family: MathJax_Main-bold;">G</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.804em; left: 0.912em;"><span class="texatom" id="MathJax-Span-5420"><span class="mrow" id="MathJax-Span-5421"><span class="mi" id="MathJax-Span-5422" style="font-size: 70.7%; font-family: MathJax_Main-bold;">i</span><span class="mo" id="MathJax-Span-5423" style="font-size: 70.7%; font-family: MathJax_Main-bold;">,</span><span class="mi" id="MathJax-Span-5424" style="font-size: 70.7%; font-family: MathJax_Main-bold;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-5425" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.219em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">G</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">i</mi><mo mathvariant="bold">,</mo><mi mathvariant="bold">j</mi></mrow></msub></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-548">G = \max(\mathbf{G_{i,j}})</script>. Since no cell has an initial height larger than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-549-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5426" style="width: 0.912em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.798em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1000.8em, 2.332em, -999.997em); top: -2.156em; left: 0em;"><span class="mrow" id="MathJax-Span-5427"><span class="mi" id="MathJax-Span-5428" style="font-family: MathJax_Math-italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-549">G</script>, and she
  will never increase the height of the cell with the largest height, she observes that the number of
  buckets is at most <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-550-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5429" style="width: 0.912em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.798em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.31em, 1000.8em, 2.332em, -999.997em); top: -2.156em; left: 0em;"><span class="mrow" id="MathJax-Span-5430"><span class="mi" id="MathJax-Span-5431" style="font-family: MathJax_Math-italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.162em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-550">G</script>. This leads to a time complexity of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-551-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo>+</mo><mi>G</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5432" style="width: 6.651em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.026em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1005.91em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5433"><span class="mi" id="MathJax-Span-5434" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5435" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5436"><span class="mrow" id="MathJax-Span-5437"><span class="mi" id="MathJax-Span-5438" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5439" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5440" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5441"><span class="mi" id="MathJax-Span-5442" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5443" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mi" id="MathJax-Span-5444" style="font-family: MathJax_Math-italic; padding-left: 0.23em;">G</span><span class="mo" id="MathJax-Span-5445" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo>+</mo><mi>G</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-551">O(\mathbf{R} \cdot \mathbf{C} + G)</script>.
</p>
<p>
  Barbara can improve this further. Notice that all cells in the final grid will have a height of at
  least <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-552-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo>+</mo><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5446" style="width: 7.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.707em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.423em, 1006.65em, 2.503em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5447"><span class="mi" id="MathJax-Span-5448" style="font-family: MathJax_Math-italic;">G</span><span class="mo" id="MathJax-Span-5449" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="texatom" id="MathJax-Span-5450" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5451"><span class="mi" id="MathJax-Span-5452" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5453" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="texatom" id="MathJax-Span-5454" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5455"><span class="mi" id="MathJax-Span-5456" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5457" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-5458" style="font-family: MathJax_Main; padding-left: 0.23em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo>+</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-552">G - \mathbf{R} - \mathbf{C} + 2</script>. She achieves this value by decreasing the height by 1 with each step
  away from the highest cell. The maximum number of steps occurs when the highest cell is in a
  corner of the grid: the opposite corner is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-553-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo>&amp;#x2212;</mo><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5459" style="width: 5.116em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.662em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.423em, 1004.61em, 2.503em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5460"><span class="texatom" id="MathJax-Span-5461"><span class="mrow" id="MathJax-Span-5462"><span class="mi" id="MathJax-Span-5463" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5464" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="texatom" id="MathJax-Span-5465" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5466"><span class="mi" id="MathJax-Span-5467" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5468" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mn" id="MathJax-Span-5469" style="font-family: MathJax_Main; padding-left: 0.23em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo>−</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-553">\mathbf{R} + \mathbf{C} - 2</script> steps away.
</p>
<p>
  Now, she can first increase the height of all cells to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-554-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo>+</mo><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5470" style="width: 7.389em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.707em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.423em, 1006.65em, 2.503em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5471"><span class="mi" id="MathJax-Span-5472" style="font-family: MathJax_Math-italic;">G</span><span class="mo" id="MathJax-Span-5473" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="texatom" id="MathJax-Span-5474" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5475"><span class="mi" id="MathJax-Span-5476" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5477" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="texatom" id="MathJax-Span-5478" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5479"><span class="mi" id="MathJax-Span-5480" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5481" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="mn" id="MathJax-Span-5482" style="font-family: MathJax_Main; padding-left: 0.23em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo>+</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-554">G - \mathbf{R} - \mathbf{C} + 2</script>, then apply the same
  bucketing approach. Except, now the number of buckets is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-555-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo>&amp;#x2212;</mo><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5483" style="width: 5.116em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.662em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.423em, 1004.61em, 2.503em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5484"><span class="texatom" id="MathJax-Span-5485"><span class="mrow" id="MathJax-Span-5486"><span class="mi" id="MathJax-Span-5487" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5488" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="texatom" id="MathJax-Span-5489" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5490"><span class="mi" id="MathJax-Span-5491" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5492" style="font-family: MathJax_Main; padding-left: 0.23em;">−</span><span class="mn" id="MathJax-Span-5493" style="font-family: MathJax_Main; padding-left: 0.23em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo>−</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-555">\mathbf{R} + \mathbf{C} - 2</script>, leading to a time
  complexity of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-556-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>R</mi></mrow><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;bold&quot;>C</mi></mrow><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5494" style="width: 14.832em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.469em; height: 0px; font-size: 110%;"><span style="position: absolute; clip: rect(1.366em, 1013.36em, 2.673em, -999.997em); top: -2.27em; left: 0em;"><span class="mrow" id="MathJax-Span-5495"><span class="mi" id="MathJax-Span-5496" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-5497" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5498"><span class="mrow" id="MathJax-Span-5499"><span class="mi" id="MathJax-Span-5500" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5501" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5502" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5503"><span class="mi" id="MathJax-Span-5504" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5505" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="texatom" id="MathJax-Span-5506" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5507"><span class="mi" id="MathJax-Span-5508" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5509" style="font-family: MathJax_Main; padding-left: 0.23em;">+</span><span class="texatom" id="MathJax-Span-5510" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5511"><span class="mi" id="MathJax-Span-5512" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5513" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5514" style="font-family: MathJax_Main; padding-left: 0.287em;">=</span><span class="mi" id="MathJax-Span-5515" style="font-family: MathJax_Math-italic; padding-left: 0.287em;">O</span><span class="mo" id="MathJax-Span-5516" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-5517"><span class="mrow" id="MathJax-Span-5518"><span class="mi" id="MathJax-Span-5519" style="font-family: MathJax_Main-bold;">R</span></span></span><span class="mo" id="MathJax-Span-5520" style="font-family: MathJax_Main; padding-left: 0.23em;">⋅</span><span class="texatom" id="MathJax-Span-5521" style="padding-left: 0.23em;"><span class="mrow" id="MathJax-Span-5522"><span class="mi" id="MathJax-Span-5523" style="font-family: MathJax_Main-bold;">C</span></span></span><span class="mo" id="MathJax-Span-5524" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.276em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">R</mi></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">C</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-556">O(\mathbf{R} \cdot \mathbf{C} + \mathbf{R} + \mathbf{C}) = O(\mathbf{R} \cdot \mathbf{C})</script>.
</p>

</p></div></div>
